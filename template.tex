%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[$fontsize$, letter]{article}
\usepackage{fontspec}

% LAYOUT
%--------------------------------
\usepackage{geometry}
\geometry{letterpaper, left=35mm, right=35mm, top=50mm, bottom=25mm}

% No page numbers
\pagenumbering{gobble}

% Left align
\usepackage[document]{ragged2e}

% Trim excessive whitespace before lists
\usepackage{enumitem}
\setlist{nolistsep}

\usepackage{wallpaper}
\ThisULCornerWallPaper{1}{letterhead-front.pdf} % Uncomment to include a different letterhead on the first page
\ULCornerWallPaper{1}{letterhead.pdf}


% LANGUAGE
%--------------------------------
\usepackage{polyglossia}
\setmainlanguage{english}

\RequirePackage[english]{isodate}

% TYPOGRAPHY
%--------------------------------
\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage[protrusion=true,final]{microtype}

\defaultfontfeatures{Scale=MatchLowercase,Mapping=tex-text}
\setsansfont[Numbers=Lowercase,LetterSpace=3,ItalicFont={Hypatia Sans Pro},ItalicFeatures={FakeSlant=0.2},BoldItalicFont={Hypatia Sans Pro Semibold},BoldItalicFeatures={FakeSlant=0.2},BoldFont={Hypatia Sans Pro Semibold}]{Hypatia Sans Pro}
\setmonofont{Courier}
\setmathrm[Numbers=Uppercase]{Warnock Pro}
\setmathsf{Hypatia Sans Pro}
\setmathtt{Courier}
\setromanfont[Numbers=Lowercase,Style=Alternate,ItalicFeatures={Style=Swash},Ligatures={Common}]{Warnock Pro}
\newfontfamily\titlefontspec[Numbers=Uppercase,Letters=SmallCaps,Style=Alternate]{Warnock Pro}
\newfontfamily\sectionfontspec[Numbers=Lowercase,Letters=SmallCaps,Style=Alternate]{Warnock Pro}
\newfontfamily\subsectionfontspec[Numbers=Lowercase,Style=Alternate]{Warnock Pro Italic}
\newfontfamily\subsubsectionfontspec[Numbers=Lowercase,Style=Alternate]{Warnock Pro Italic}
\newfontfamily\textarabic{Scheherazade-AAT}
\newfontfamily\textipa{Doulos SIL}
\newfontfamily\texthebrew{Lucida Grande}
\newfontfamily\textcyrillic{Warnock Pro}
\newfontfamily\textcyrillicsf{Hypatia Sans Pro}
\newfontfamily\textgreek{Warnock Pro}
\newfontfamily\textgreeksf{Hypatia Sans Pro}
\newfontfamily\textjapanese{Hiragino Mincho Pro}
\newfontfamily\textother{Gentium}
\newfontfamily\textaslprep{Gallaudet}
\newcommand*{\textasl}[1]{\fontsize{60}{60}\textaslprep{#1}}

% Set paragraph break
\setlength{\parskip}{1em}

% Command required by how Pandoc handles the list conversion
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% PDF SETUP
%--------------------------------
\usepackage[xetex, bookmarks, colorlinks, breaklinks]{hyperref}
\hypersetup
{
  pdfauthor={Chad Michael Eyer},
  pdfsubject={$subject$},
  pdftitle={$subject$},
  colorlinks,breaklinks,
  filecolor=black,
  urlcolor=[rgb]{0.117,0.682,0.858},
  linkcolor=[rgb]{0.117,0.682,0.858},
  linkcolor=[rgb]{0.117,0.682,0.858},
  citecolor=[rgb]{0.117,0.682,0.858}
}

% To display custom date in the example
% \usepackage[nodayofweek]{datetime}
% \newdate{date}{01}{12}{1867}
% \date{\displaydate{date}}
% Use this instead of \today
% \displaydate{date}

% DOCUMENT
%--------------------------------
\begin{document}
\small

\vspace{1em}

\normalsize \sffamily
$for(to)$
$to$\\
$endfor$

\vspace{3em}

\rmfamily
\begin{flushright}
  $if(date)$\printdate{$date$}$else$\today$endif$$if(city)$\\$city$$endif$
\end{flushright}

\vspace{1em}

$if(subject)$
\textbf{$subject$}
$endif$

\vspace{1em}

$body$

\IfFileExists{signature.pdf}
{
    \begin{FlushRight}  	\parbox[t]{0.6in}{\includegraphics[clip,angle=0,scale=.2]{signature.pdf}}
    \vspace*{-3\baselineskip}Chad Michael Eyer
    \end{FlushRight}
}

\end{document}
